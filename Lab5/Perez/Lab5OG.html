<html>
<head>
   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
   integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
   crossorigin=""/>
     <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
   integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
   crossorigin=""></script>
    
        <link rel="stylesheet" type="text/css" href="L5styling.css" media="screen"/>
        <script src="AB_CSD2016_Immigrants.js"></script>
     
	  <title>Alberta's Immigration Count'</title>
</head>
<body>
    
    <h1>Calgary's Historic Resource Locations</h1>
        <h4 class="sign">Webmap by Valery</h4>
        
    <h3>Historic resources are those evaluated by the CHA (Calgary Heritage Authority) as having significant heritage value around Calgary. They are marked to determine what locations may be elligible for conservation incentives. They include buildings, structures, archeological sites, cultural landscapes and parks - click on the icons for historic resource name, year of construction, and the intial master plan purpose.<br><br> Locations are found throughout all parts of Calgary. Scroll around and zoom in and out to view different locations and their density. <br><a class="button button1"href="https://www.international.gc.ca/world-monde/issues_development-enjeux_developpement/response_conflict-reponse_conflits/crisis-crises/conflict_syria-syrie.aspx?lang=eng" target="_blank">Syrian Crisis</a></h3>
	
     <h4 class="sign">Webmap by Valery</h4>
    
     <div id="mapid" class="centermap outline" style="height: 80%; width: 60%;">
             
        <script> 
    var mymap = L.map('mapid').setView([55.2764183,-114.8065366], 5);  
            
        L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
    maxZoom: 18,
    id: 'mapbox/streets-v11',
    tileSize: 512,
    zoomOffset: -1,
    accessToken: 'pk.eyJ1IjoidmFsY2hhZmlhIiwiYSI6ImNrZm15bTB3OTAyd3MycXBnczl2YWhua3QifQ.EvMP5t8wY9B7uyDDhwFC7A' 
        }).addTo(mymap);
            

    L.geoJson(IMMS).addTo(mymap);    
	
	//Adding colours 
	function getColor(d) {
	    return d > 50000 ? '#4A235A ' :
	           d > 20000  ? '#5B2C6F' :
	           d > 10000  ? '#1B4F72' :
		  	   d > 7000  ? '#21618C' :
		       d > 5000  ? '#6C3483' :
		       d > 4000  ? '#7D3C98' :
		       d > 3000  ? '#2874A6' :
		       d > 2000  ? '#2E86C1 ' :
		 	   d > 700  ? '#8E44AD' :
			   d > 500  ? '#A569BD' :
	           d > 300  ? '#3498DB' :
	           d > 100   ? '#5DADE2' :
	           d > 30   ? '#BB8FCE' :
	           d > 0  ? '#5DADE2' :
	                      '#F4ECF7';}
	
	function style(feature) {
	    return {
	        fillColor: getColor(feature.properties.Immigrants),
	        weight: 2,
	        opacity: 1,
	        color: 'white',
	        dashArray: '3',
	        fillOpacity: 0.7
	    };
	}

	L.geoJson(IMMS, {style: style}).addTo(mymap);
	
	//Interaction
	
    function highlightFeature(e) {
     var layer = e.target;

     layer.setStyle({
         weight: 5,
         color: '#666',
         dashArray: '',
         fillOpacity: 0.7
        
    
     });

     if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
         layer.bringToFront();
     }
           info.update(layer.feature.properties);
 }
      
       function resetHighlight(e) {
     geojson.resetStyle(e.target);
            info.update();
 }
      
       function onEachFeature(feature, layer) {
     layer.on({
         mouseover: highlightFeature,
         mouseout: resetHighlight
     });
 }

 geojson = L.geoJson(IMMS, {
     style: style,
     onEachFeature: onEachFeature
 }).addTo(mymap);
 
 //Custom info control
 
  var info = L.control();

info.onAdd = function (mymap) {
    this._div = L.DomUtil.create('div', 'info'); 
    this.update();
    return this._div;
};

info.update = function (props) {
    this._div.innerHTML = '<h4>Immigrant Count</h4>' +  (props ?
        '<b>' + props.CSDNAME + '</b><br/>' + 'Immigrants: ' + props.Immigrants + '</b><br/>' + 'Immigrants from 2006-2010: ' + props.IImm06_10 + '</b><br/>' + 'Immigrants from 2011-2016: ' + props.Imm11_16 + '</b><br/>' + 'Non-permanent residents: '+props.nonperm_res + '</b><br/>'+'Non-immigrants: '+ props.non_immigrants
        : 'Hover over a census subdivision ');
};
      

info.addTo(mymap);

//Legend 

var legend = L.control({position: 'bottomright'});

  legend.onAdd = function (mymap) {

      var div = L.DomUtil.create('div', 'info legend'),
          grades = [0, 30, 100, 300, 500, 700, 2000, 3000, 4000, 5000, 7000, 10000, 20000],
          labels = [ ];  
		  
      for (var i = 0; i < grades.length; i++) {
          div.innerHTML +=
              '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
              grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
      }

      return div;
  };

  legend.addTo(mymap);

             
    
         </script>

    
    
</body>
    
</html>